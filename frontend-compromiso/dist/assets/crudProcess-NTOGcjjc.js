import{r as s,j as e,c as j,S as a,b as S,F as A,f as C}from"./index-CXkMEiwO.js";import{M as D,C as N}from"./Datatable--g9hJFft.js";const w=({proceso:t,handleSubmit:E,buttonForm:u})=>{const[c,i]=s.useState(""),[p,d]=s.useState(""),[l,f]=s.useState("Activo"),[g,m]=s.useState({}),[b,x]=s.useState(null);s.useEffect(()=>{t?(i(t.nombre_proceso||""),d(t.nombre_directorio_proceso||""),f(t.estado||"Activo"),x(t.id_proceso||null)):o()},[t]);const P=()=>{const r={};return(!c||c.length<3)&&(r.nombreProceso="El nombre del proceso es obligatorio y debe tener al menos 3 caracteres."),m(r),Object.keys(r).length===0},h=r=>{const{name:n,value:v}=r.target;n==="nombreProceso"&&!/^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$/.test(v)||(n==="nombreProceso"?i(v):n==="nombreDirectorioProceso"?d(v):f(v))},y=r=>{r.preventDefault(),P()&&(E(r,{id:b,nombre_proceso:c,nombre_directorio_proceso:p,estado:l}),o())},o=()=>{i(""),d(""),f("Activo"),x(null),m({})};return e.jsx("div",{className:"form-container",children:e.jsxs("form",{onSubmit:y,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nombreProceso",children:"Nombre del Proceso:"}),e.jsx("input",{type:"text",name:"nombreProceso",value:c,onChange:h,required:!0,"aria-describedby":"nombreProcesoError"}),g.nombreProceso&&e.jsx("span",{id:"nombreProcesoError",className:"error",children:g.nombreProceso})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nombreDirectorioProceso",children:"Nombre del Directorio del Proceso:"}),e.jsx("input",{type:"text",name:"nombreDirectorioProceso",value:p,onChange:h})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"estado",children:"Estado:"}),e.jsxs("select",{name:"estado",value:l,onChange:h,children:[e.jsx("option",{value:"Activo",children:"Activo"}),e.jsx("option",{value:"Inactivo",children:"Inactivo"})]})]}),b&&e.jsx("input",{type:"hidden",value:b}),e.jsx("button",{type:"submit",className:"btn-submit",children:u})]})})},I=()=>{const[t,E]=s.useState([]),[u,c]=s.useState(null),[i,p]=s.useState("Enviar"),[d,l]=s.useState(!1),[f,g]=s.useState(!0);s.useEffect(()=>{m()},[]);const m=async()=>{try{const o=await j.get("/api/procesos");E(o.data)}catch(o){console.error("Error al obtener los procesos:",o),a.fire("Error","No se pudieron obtener los procesos","error")}},b=async(o,r)=>{o.preventDefault();try{i==="Enviar"?(await j.post("/api/procesos",r),a.fire("Agregado!","El proceso ha sido agregado.","success")):i==="Actualizar"&&u&&(await j.put(`/api/procesos/${u.id_proceso}`,r),a.fire("Actualizado!","El proceso ha sido actualizado.","success")),x(),l(!1),m()}catch(n){console.error("Error al enviar el formulario:",n),a.fire("Error","No se pudo guardar el proceso","error")}},x=()=>{c(null),p("Enviar")},P=[{field:"id_proceso",header:"ID",width:"10%"},{field:"nombre_proceso",header:"Nombre",width:"60%"},{field:"estado",header:"Estado",width:"20%"}],h=o=>{c(o),p("Actualizar"),l(!0)},y=async o=>{if((await a.fire({title:"¿Estás seguro?",text:"¡No podrás revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Sí, eliminarlo!"})).isConfirmed)try{(await j.delete(`/api/procesos/${o.id_proceso}`)).status===204?(a.fire("Eliminado!","El proceso ha sido eliminado.","success"),m()):a.fire("Error","No se pudo eliminar el proceso","error")}catch(n){console.error("Error al eliminar el proceso:",n),a.fire("Error","No se pudo eliminar el proceso","error")}};return e.jsxs("div",{style:{display:"flex",minHeight:"100vh",backgroundColor:"#f4f4f4"},children:[e.jsx(S,{}),e.jsxs("div",{style:{flex:1,padding:"20px",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[e.jsx("h1",{style:{marginBottom:"20px",fontSize:"2rem",fontFamily:"Georgia, serif",textTransform:"uppercase"},children:"Gestión de Procesos"}),e.jsxs("div",{style:{width:"100%",maxWidth:"1200px",display:"flex",flexDirection:"column",alignItems:"center",gap:"20px"},children:[e.jsxs("button",{style:{display:"flex",alignItems:"center",padding:"10px 20px",fontSize:"1rem",backgroundColor:"#4caf50",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",marginBottom:"20px"},onClick:()=>{x(),l(!0)},children:[e.jsx(A,{icon:C,style:{marginRight:"8px"}}),"Añadir"]}),d&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:999}}),e.jsx(D,{isOpen:d,onClose:()=>{l(!1),g(!0)},title:i==="Enviar"?"Agregar Proceso":"Actualizar Proceso",children:e.jsx(w,{proceso:u,handleSubmit:b,buttonForm:i})}),f&&e.jsx(N,{data:t,columns:P,onEdit:h,onDelete:y,searchField:"nombre_proceso",exportFields:["id_proceso","nombre_proceso","estado"]})]})]})]})};export{I as default};
