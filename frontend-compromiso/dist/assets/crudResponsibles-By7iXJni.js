import{r as o,j as e,F as y,f as R,c as v,S as t,b as w}from"./index-CXkMEiwO.js";import{M as F,C as N}from"./Datatable--g9hJFft.js";const I=({responsable:a,handleSubmit:E,buttonForm:b})=>{const[l,n]=o.useState(""),[u,d]=o.useState("Activo"),[i,x]=o.useState({}),[m,p]=o.useState(null);o.useEffect(()=>{a?(n(a.nombre_responsable||""),d(a.estado||"Activo"),p(a.id_responsable||null)):g()},[a]);const j=()=>{const s={};return(!l||l.length<3)&&(s.nombreResponsable="El nombre es obligatorio y debe tener al menos 3 caracteres."),x(s),Object.keys(s).length===0},h=s=>{s.preventDefault(),j()&&(E(s,{id:m,nombre_responsable:l,estado:u}),g())},g=()=>{n(""),d("Activo"),p(null),x({})};return e.jsx("div",{className:"form-container",children:e.jsxs("form",{onSubmit:h,children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"nombreResponsable",children:[e.jsx(y,{icon:R})," Nombre del Responsable"]}),e.jsx("input",{id:"nombreResponsable",type:"text",value:l,onChange:s=>n(s.target.value),required:!0,"aria-describedby":"nombreResponsableError"}),i.nombreResponsable&&e.jsx("span",{id:"nombreResponsableError",className:"error",children:i.nombreResponsable})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"estado",children:"Estado"}),e.jsxs("select",{id:"estado",value:u,onChange:s=>d(s.target.value),children:[e.jsx("option",{value:"Activo",children:"Activo"}),e.jsx("option",{value:"Inactivo",children:"Inactivo"})]})]}),m&&e.jsx("input",{type:"hidden",value:m}),e.jsx("button",{type:"submit",className:"btn-submit",children:b})]})})},D=()=>{const[a,E]=o.useState([]),[b,l]=o.useState(null),[n,u]=o.useState("Enviar"),[d,i]=o.useState(!1),[x,m]=o.useState(!0);o.useEffect(()=>{p()},[]);const p=async()=>{try{const r=await v.get("/api/responsables");E(r.data)}catch(r){console.error("Error al obtener los responsables:",r),t.fire("Error","No se pudieron obtener los responsables","error")}},j=async(r,c)=>{r.preventDefault();const f=g(c);if(f){t.fire("Error",f,"error");return}try{n==="Enviar"?(await v.post("/api/responsables",c),t.fire("Agregado!","El responsable ha sido agregado.","success")):n==="Actualizar"&&b&&(await v.put(`/api/responsables/${b.id_responsable}`,c),t.fire("Actualizado!","El responsable ha sido actualizado.","success")),h(),i(!1),p()}catch(C){console.error("Error al enviar el formulario:",C),t.fire("Error","No se pudo guardar el responsable","error")}},h=()=>{l(null),u("Enviar")},g=r=>{const{nombre_responsable:c}=r;return c?/^[A-Za-z\s]+$/.test(c)?null:"El nombre solo puede contener letras.":"El nombre es obligatorio."},s=[{field:"id_responsable",header:"ID",width:"10%"},{field:"nombre_responsable",header:"Nombre",width:"70%"},{field:"estado",header:"Estado",width:"20%"}],A=r=>{l(r),u("Actualizar"),i(!0)},S=async r=>{if((await t.fire({title:"¿Estás seguro?",text:"¡No podrás revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Sí, eliminarlo!"})).isConfirmed)try{(await v.delete(`/api/responsables/${r.id_responsable}`)).status===204?(t.fire("Eliminado!","El responsable ha sido eliminado.","success"),p()):t.fire("Error","No se pudo eliminar el responsable","error")}catch(f){console.error("Error al eliminar el responsable:",f),t.fire("Error","No se pudo eliminar el responsable","error")}};return e.jsxs("div",{style:{display:"flex",minHeight:"100vh",backgroundColor:"#f4f4f4"},children:[e.jsx(w,{}),e.jsxs("div",{style:{flex:1,padding:"20px",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[e.jsx("h1",{style:{marginBottom:"20px",fontSize:"2rem",fontFamily:"Georgia, serif",textTransform:"uppercase"},children:"Gestión de Responsables"}),e.jsxs("div",{style:{width:"100%",maxWidth:"1200px",display:"flex",flexDirection:"column",alignItems:"center",gap:"20px"},children:[e.jsxs("button",{style:{display:"flex",alignItems:"center",padding:"10px 20px",fontSize:"1rem",backgroundColor:"#4caf50",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",marginBottom:"20px"},onClick:()=>{h(),i(!0)},children:[e.jsx(y,{icon:R,style:{marginRight:"8px"}}),"Añadir"]}),d&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:999}}),e.jsx(F,{isOpen:d,onClose:()=>{i(!1),m(!0)},title:n==="Enviar"?"Agregar Responsable":"Actualizar Responsable",children:e.jsx(I,{responsable:b,handleSubmit:j,buttonForm:n})}),x&&e.jsx(N,{data:a,columns:s,onEdit:A,onDelete:S,searchField:"nombre_responsable",exportFields:["id_responsable","nombre_responsable","estado"]})]})]})]})};export{D as default};
