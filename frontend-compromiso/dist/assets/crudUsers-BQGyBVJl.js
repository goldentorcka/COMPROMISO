import{r as a,j as e,a as m,S as s,b as w,F as C,f as N}from"./index-CXkMEiwO.js";import{M as S,C as F}from"./Datatable--g9hJFft.js";const D=()=>{const[n,p]=a.useState({username:"",email:"",password:""}),{username:l,email:f,password:t}=n,o=c=>{const{name:u,value:d}=c.target;p({...n,[u]:d})},h=async c=>{c.preventDefault();try{await m.post("http://149.50.128.50:1337/api/auth/register",n),alert("Registro exitoso. Por favor, ya puedes iniciar sesión con otra cuenta"),i()}catch(u){console.error("Error de registro:",u),alert("Error en el registro. Por favor, intenta de nuevo.")}},i=()=>{p({username:"",email:"",password:""})};return e.jsxs("div",{className:"container mt-5",children:[e.jsx("h2",{children:"Registro"}),e.jsxs("form",{onSubmit:h,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"username",className:"form-label",children:"Nombre de usuario:"}),e.jsx("input",{type:"text",className:"form-control",id:"username",name:"username",value:l,onChange:o,required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"email",className:"form-label",children:"Email:"}),e.jsx("input",{type:"email",className:"form-control",id:"email",name:"email",value:f,onChange:o,required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"password",className:"form-label",children:"Contraseña:"}),e.jsx("input",{type:"password",className:"form-control",id:"password",name:"password",value:t,onChange:o,required:!0})]}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Registrarse"})]})]})},z=()=>{const[n,p]=a.useState([]),[l,f]=a.useState(null),[t,o]=a.useState("Enviar"),[h,i]=a.useState(!1),[c,u]=a.useState(!0);a.useEffect(()=>{d()},[]);const d=async()=>{try{const r=await m.get("http://149.50.128.50:1337/api/auth");p(r.data)}catch(r){console.error("Error al obtener los usuarios:",r),s.fire("Error","No se pudieron obtener los usuarios","error")}},j=async(r,g)=>{r.preventDefault();try{t==="Enviar"?(await m.post("http://149.50.128.50:1337/api/auth/register",g),s.fire("Agregado!","El usuario ha sido agregado.","success")):t==="Actualizar"&&l&&(await m.put(`http://149.50.128.50:1337/api/auth/${l.id}`,g),s.fire("Actualizado!","El usuario ha sido actualizado.","success")),b(),i(!1),d()}catch(x){console.error("Error al enviar el formulario:",x),s.fire("Error","No se pudo guardar el usuario","error")}},b=()=>{f(null),o("Enviar")},y=[{field:"id",header:"ID",width:"10%"},{field:"email",header:"Email",width:"50%"},{field:"rol",header:"Rol",width:"20%"}],v=r=>{f(r),o("Actualizar"),i(!0)},E=async r=>{if((await s.fire({title:"¿Estás seguro?",text:"¡No podrás revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Sí, eliminarlo!"})).isConfirmed)try{(await m.delete(`http://149.50.128.50:1337/api/auth/${r.id}`)).status===204?(s.fire("Eliminado!","El usuario ha sido eliminado.","success"),d()):s.fire("Error","No se pudo eliminar el usuario","error")}catch(x){console.error("Error al eliminar el usuario:",x),s.fire("Error","No se pudo eliminar el usuario","error")}};return e.jsxs("div",{style:{display:"flex",minHeight:"100vh",backgroundColor:"#f4f4f4"},children:[e.jsx(w,{})," ",e.jsxs("div",{style:{flex:1,padding:"20px",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[e.jsx("h1",{style:{marginBottom:"20px",fontSize:"2rem",fontFamily:"Georgia, serif",textTransform:"uppercase"},children:"Gestión de Usuarios"}),e.jsxs("div",{style:{width:"100%",maxWidth:"1200px",display:"flex",flexDirection:"column",alignItems:"center",gap:"20px"},children:[e.jsxs("button",{style:{display:"flex",alignItems:"center",padding:"10px 20px",fontSize:"1rem",backgroundColor:"#4caf50",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",marginBottom:"20px"},onClick:()=>{b(),i(!0)},children:[e.jsx(C,{icon:N,style:{marginRight:"8px"}}),"Añadir"]}),h&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:999}}),e.jsx(S,{isOpen:h,onClose:()=>{i(!1),u(!0)},title:t==="Enviar"?"Agregar Usuario":"Actualizar Usuario",children:e.jsx(D,{user:l,handleSubmit:j,buttonForm:t})}),c&&e.jsx(F,{data:n,columns:y,onEdit:v,onDelete:E,searchField:"email",exportFields:["id","email","rol"]})]})]})]})};export{z as default};
